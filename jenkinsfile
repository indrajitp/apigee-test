pipeline {
    agent any

    stages {
		stage('CheckOutSourceCode') {
            steps {
                git 'https://github.com/indrajitp/apigee-test.git'
            }
        }
        stage('Build') {
            steps {
               sh """
	       
		USER_HOME=$JENKINS_HOME/apiproxies/
		cd $JENKINS_HOME
		ls -ltr
		cd -
		#check commit differences  between two commits
		git diff HEAD^ HEAD| xargs > somefile
		echo "storing the changes in somefile"
		cd ${USER_HOME}
		DIRS=`ls -l $MYDIR | egrep '^d' | awk '{print $9}'`
		echo $DIRS
		"""
            }
        }
        stage('Test') {
            steps {
                echo 'Testing..'
            }
        }
        stage('Deploy') {
            steps {
                echo 'Deploying....'
            }
        }
    }
}
